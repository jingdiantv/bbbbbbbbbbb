ipv6: true
allow-lan: true
mixed-port: 7890
unified-delay: false
tcp-concurrent: true
external-controller: 127.0.0.1:9090
external-ui: ui
external-ui-url: https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip
geo-update-interval: 24
geodata-mode: true
geox-url:
  geoip: https://mirror.ghproxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat
  geosite: https://mirror.ghproxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat
  mmdb: https://mirror.ghproxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country-lite.mmdb
find-process-mode: strict
global-client-fingerprint: chrome
profile:
  store-selected: true
  store-fake-ip: true
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
tun:
  enable: true
  stack: mixed
  dns-hijack:
    - any:53
  auto-route: true
  auto-detect-interface: true
dns:
  enable: true
  listen: :1053
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 28.0.0.1/8
  fake-ip-filter:
    - "*"
    - +.lan
    - +.local
  nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
  proxy-server-nameserver:
    - https://doh.pub/dns-query
  nameserver-policy:
    geosite:private:
      - https://doh.pub/dns-query
      - https://dns.alidns.com/dns-query
    geosite:geolocation-!cn:
      - https://dns.cloudflare.com/dns-query#dns
      - https://dns.google/dns-query#dns
proxies:
        - *
proxy-groups:
  - name: 🌐 节点选择
    type: select
    proxies:
      - ♻️ 自动选择
      - 🔯 故障转移
      - 🔮 负载均衡
      - DIRECT
      - *
  - name: ♻️ 自动选择
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    proxies:
      - *
  - name: 🔯 故障转移
    type: fallback
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    proxies:
      - *
  - name: 🔮 负载均衡
    type: load-balance
    strategy: consistent-hashing
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    proxies:
      - *
  - name: 🌏 国内媒体
    type: select
    proxies:
      - 🎯 全球直连
      - 🌐 节点选择
      - ♻️ 自动选择
      - 🔯 故障转移
      - 🔮 负载均衡
      - *
  - name: 🌍 国外媒体
    type: select
    proxies:
      - 🌐 节点选择
      - ♻️ 自动选择
      - 🔯 故障转移
      - 🔮 负载均衡
      - 🎯 全球直连
      - *
  - name: 📢 谷歌FCM
    type: select
    proxies:
      - 🌐 节点选择
      - ♻️ 自动选择
      - 🔯 故障转移
      - 🔮 负载均衡
      - 🎯 全球直连
      - *
  - name: Ⓜ️ 微软服务
    type: select
    proxies:
      - 🎯 全球直连
      - 🌐 节点选择
      - ♻️ 自动选择
      - 🔯 故障转移
      - 🔮 负载均衡
      - *
  - name: 🍎 苹果服务
    type: select
    proxies:
      - 🎯 全球直连
      - 🌐 节点选择
      - ♻️ 自动选择
      - 🔯 故障转移
      - 🔮 负载均衡
      - *
  - name: 📲 电报消息
    type: select
    proxies:
      - 🌐 节点选择
      - ♻️ 自动选择
      - 🔯 故障转移
      - 🔮 负载均衡
      - 🎯 全球直连
      - *
  - name: 📹 油管视频
    type: select
    proxies:
      - 🌐 节点选择
      - ♻️ 自动选择
      - 🔯 故障转移
      - 🔮 负载均衡
      - 🎯 全球直连
      - *
  - name: 🎯 全球直连
    type: select
    proxies:
      - DIRECT
      - 🌐 节点选择
      - ♻️ 自动选择
  - name: 🛑 全球拦截
    type: select
    proxies:
      - REJECT
      - DIRECT
  - name: 🐟 漏网之鱼
    type: select
    proxies:
      - 🌐 节点选择
      - ♻️ 自动选择
      - 🔯 故障转移
      - 🔮 负载均衡
      - *

#规则
rule-providers:
  LocalAreaNetwork:
    type: http
    behavior: domain
    url: "https://mirror.ghproxy.com/https://raw.githubusercontent.com/mphin/ProxyTools/main/rules/classical/LocalAreaNetwork.yaml"
    path: ./Ruleset/LocalAreaNetwork.yaml
    interval: 86400
  Google:
    type: http
    behavior: domain
    url: "https://mirror.ghproxy.com/https://raw.githubusercontent.com/mphin/ProxyTools/main/rules/classical/Google.yaml"
    path: ./Ruleset/Google.yaml
    interval: 86400
  OpenaiNetflix:
    type: http
    behavior: domain
    url: "https://mirror.ghproxy.com/https://raw.githubusercontent.com/mphin/ProxyTools/main/rules/classical/OpenaiNetflix.yaml"
    path: ./Ruleset/OpenaiNetflix.yaml
    interval: 86400
  ProxyMedia:
    type: http
    behavior: domain
    url: "https://mirror.ghproxy.com/https://raw.githubusercontent.com/mphin/ProxyTools/main/rules/classical/ProxyMedia.yaml"
    path: ./Ruleset/ProxyMedia.yaml
    interval: 86400
  Microsoft:
    type: http
    behavior: domain
    url: "https://mirror.ghproxy.com/https://raw.githubusercontent.com/mphin/ProxyTools/main/rules/classical/Microsoft.yaml"
    path: ./Ruleset/Microsoft.yaml
    interval: 86400
  Apple:
    type: http
    behavior: domain
    url: "https://mirror.ghproxy.com/https://raw.githubusercontent.com/mphin/ProxyTools/main/rules/classical/Apple.yaml"
    path: ./Ruleset/Apple.yaml
    interval: 86400
  ChinaMedia:
    type: http
    behavior: domain
    url: "https://mirror.ghproxy.com/https://raw.githubusercontent.com/mphin/ProxyTools/main/rules/classical/ChinaMedia.yaml"
    path: ./Ruleset/ChinaMedia.yaml
    interval: 86400
  Telegram:
    type: http
    behavior: domain
    url: "https://mirror.ghproxy.com/https://raw.githubusercontent.com/mphin/ProxyTools/main/rules/classical/Telegram.yaml"
    path: ./Ruleset/Telegram.yaml
    interval: 86400
  ProxyGFWlist:
    type: http
    behavior: domain
    url: "https://mirror.ghproxy.com/https://raw.githubusercontent.com/mphin/ProxyTools/main/rules/classical/ProxyGFWlist.yaml"
    path: ./Ruleset/ProxyGFWlist.yaml
    interval: 86400
  GlobalDirect:
    type: http
    behavior: domain
    url: "https://mirror.ghproxy.com/https://raw.githubusercontent.com/mphin/ProxyTools/main/rules/classical/GlobalDirect.yaml"
    path: ./Ruleset/GlobalDirect.yaml
    interval: 86400
  YouTube:
    type: http
    behavior: domain
    url: "https://mirror.ghproxy.com/https://raw.githubusercontent.com/ClodQiu/Clash.Base64/Grey/Ruleset/YouTube.yaml"
    path: ./Ruleset/YouTube.yaml
    interval: 86400

rules:
  - RULE-SET,LocalAreaNetwork,🎯 全球直连
  - DOMAIN,clash.razord.top,🎯 全球直连
  - DOMAIN,yacd.haishan.me,🎯 全球直连
  - RULE-SET,Google,📢 谷歌FCM
  - RULE-SET,ProxyMedia,🌍 国外媒体
  - RULE-SET,Microsoft,Ⓜ️ 微软服务
  - RULE-SET,Apple,🍎 苹果服务
  - RULE-SET,ChinaMedia,🌏 国内媒体
  - RULE-SET,Telegram,📲 电报消息
  - RULE-SET,YouTube,📹 油管视频
  - RULE-SET,ProxyGFWlist,🌐 节点选择
  - RULE-SET,GlobalDirect,🎯 全球直连
  - GEOIP,LAN,🎯 全球直连,no-resolve
  - GEOIP,CN,🎯 全球直连,no-resolve
  - MATCH,🌐 节点选择
